Sub CentrairPlazaDX1()
    Dim wsOrderSheet As Worksheet, wsGeneralLeadTime As Worksheet, wsSpecialLeadTime As Worksheet, wsROYLeadTime As Worksheet
    Dim nrow As Long, generalOrderDayColumn As Integer, specialOrderDayColumn As Integer, royOrderDayColumn As Integer
    Dim orderDay As String, productCode As String, brandCode As String
    Dim isGeneralOrderable As Boolean, isSpecialOrderable As Boolean, isROYOrderable As Boolean

    ' シートの参照を設定します。
    Set wsOrderSheet = ThisWorkbook.Sheets("食品全体（原紙）")
    Set wsGeneralLeadTime = ThisWorkbook.Sheets("一般リードタイム")
    Set wsSpecialLeadTime = ThisWorkbook.Sheets("特殊リードタイム")
    Set wsROYLeadTime = ThisWorkbook.Sheets("ROYリードタイム")

    ' 注文日を取得します。
    orderDay = wsOrderSheet.Range("T3").Value
    ' 注文日に該当する列を取得します。
    generalOrderDayColumn = WorksheetFunction.Match(orderDay, wsGeneralLeadTime.Rows(1), 0)
    specialOrderDayColumn = generalOrderDayColumn + 2
    
    ' 「食品全体（原紙）」の商品リストをループ処理します。
    For nrow = 5 To wsOrderSheet.Cells(Rows.Count, "A").End(xlUp).Row
        productCode = wsOrderSheet.Cells(nrow, "B").Value
        brandCode = wsOrderSheet.Cells(nrow, "A").Value

        ' 一般リードタイムでブランドが注文可能かどうかを確認します。
        isGeneralOrderable = True
        With wsGeneralLeadTime
            Dim foundGeneralCell As Range
            Set foundGeneralCell = .Range("A:A").Find(brandCode, LookIn:=xlValues, LookAt:=xlWhole)
            If Not foundGeneralCell Is Nothing Then
                isGeneralOrderable = .Cells(foundGeneralCell.Row, generalOrderDayColumn).Value <> "×"
            End If
        End With

        ' 特殊リードタイムで商品コードを検索します。
        isSpecialOrderable = False
        With wsSpecialLeadTime
            Dim foundSpecialCell As Range
            Set foundSpecialCell = .Range("B:B").Find(productCode, LookIn:=xlValues, LookAt:=xlWhole)
            If Not foundSpecialCell Is Nothing Then
                isSpecialOrderable = .Cells(foundSpecialCell.Row, specialOrderDayColumn).Value <> "×"
            Else
                isSpecialOrderable = False ' 見つからなければ特別注文可能ではありません。
            End If
        End With

        ' ROYリードタイムでROYブランドを確認します。
        isROYOrderable = True
        If brandCode = "ROY" Then
            Dim foundROYCell As Range
            Set foundROYCell = wsROYLeadTime.Columns("B:B").Find(What:=orderDay, LookIn:=xlValues, LookAt:=xlWhole)
            If Not foundROYCell Is Nothing Then
                royOrderDayColumn = foundROYCell.Column
                isROYOrderable = wsROYLeadTime.Cells(foundROYCell.Row, royOrderDayColumn + 2).Value <> "×"
            Else
                isROYOrderable = False
            End If
        End If

        ' 注文可能かどうかに基づいて行の表示/非表示を設定します。
        If brandCode = "ROY" Then
            wsOrderSheet.Rows(nrow).Hidden = Not isROYOrderable
        Else
            wsOrderSheet.Rows(nrow).Hidden = Not (isGeneralOrderable Or isSpecialOrderable)
        End If
    Next nrow
    
    ' 確認メッセージボックスを表示します。
    MsgBox "Hi, Buddy! 本日発注可能な商品を更新しましたよ。", vbInformation
End Sub
